Except as otherwise stated, the code is copyright 2013 Juris Breidaks, Martins Liberts.